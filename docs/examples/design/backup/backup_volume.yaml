apiVersion: stash.appscode.com/v1alpha2
kind: BackupConfiguration
metadata:
  name: volume-backup-demo
  namespace: demo
spec:
  schedule: '@every 1h'
  # backupProcedure indicates Procedure crd that specifies the steps to backup a volume.
  # stash will create some default Procedure crd  while install to backup/recover various resources.
  # user can also crate their own Procedure to customize backup/recovery
  backupProcedure: volumeBackup
  # repository refers to the Repository crd that hold backend information
  repository:
    name: stash-backup-repo
  # target indicate the target workload that we want to backup
  target:
    volume:
      mountPath: /source/data
      persistentVolumeClaim:
        claimName: stash-recovered
  # retentionPolicies specify the policy to follow to clean old backup snapshots
  retentionPolicy:
    keepLast: 5
    prune: true
